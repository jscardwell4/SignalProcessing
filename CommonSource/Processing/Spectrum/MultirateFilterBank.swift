//
//  MultirateFilterBank
//  Chord Finder
//
//  Created by Jason Cardwell on 7/21/17.
//  Copyright (c) 2017 Moondeer Studios. All rights reserved.
//
import Foundation
import AVFoundation
import Accelerate

/// A multirate filter bank implementation with concept and coefficients based on
/// https://www.audiolabs-erlangen.de/resources/MIR/chromatoolbox/.
public class MultirateFilterBank {

  public static let shared: MultirateFilterBank = MultirateFilterBank()

  /// The filters used to decompose the signal.
  /// There are currently filters for MIDI pitches 21 through 120.
  private let filters: [IIRFilter?]

  /// Default initializer. Loads the filter coefficients from a bundled file.
  private init() {

      filters = filterCoefficients.map {
        a, b in

        guard !(a.isEmpty || b.isEmpty) else { return nil }

        return IIRFilter(a: a, b: b)

      }

  }

  /// Calculates and returns the STMSP values using the specified buffer.
  ///
  /// - Parameters:
  ///   - buffer: The buffer for which the energy values are to be calculated.
  ///   - windowSize: The window size to use while processing the 22050 Hz signal. Window
  ///                 sizes for the other two sample rates will be derived from this value.
  ///   - hopSize: The hop size to use while processing the 22050 Hz signal. Hop sizes for
  ///              the other two sample rates will be derived from this value.
  /// - Returns: A buffer of pitch features extracted from `buffer`.
  public func pitchBuffer(from buffer: MultirateAudioPCMBuffer,
                          windowSize: Int,
                          hopSize: Int) -> PitchBuffer
  {

    // Calculate the total number of frames in the result.
    // The last frame seems to always be garbage so the `+ 1` has been commented out.
    let frameCount = buffer[22050].count / hopSize// + 1

    // Create a buffer of pitch vectors.
    let stmspFrames = UnsafeMutablePointer<PitchVector>.allocate(capacity: frameCount)
    for frame in 0 ..< frameCount { (stmspFrames + frame).initialize(to: PitchVector()) }

    // Allocate memory for a vector of window starting indices.
    let windowStart = FloatBuffer.allocate(capacity: frameCount)

    // Use the hop size negated for the initial value.
    var hopSize = Float(hopSize)
    var initialValue: Float = -hopSize

    // Fill `windowStart` with a ramped vector incremented by `hopSize`.
    vDSP_vramp(&initialValue, &hopSize, windowStart, 1, vDSP_Length(frameCount))

    // Correct the first window's starting index.
    windowStart[0] = 0

    // Allocate memory for a vector of window ending indices.
    let windowStop = FloatBuffer.allocate(capacity: frameCount)

    // Fill `windowStop` by adding `windowSize` to the values in `windowStart`.
    var windowSize = Float(windowSize)
    vDSP_vsadd(windowStart, 1, &windowSize, windowStop, 1, vDSP_Length(frameCount))

    // Get the maximum value for an index marking the end of a window.
    let windowMax = Float(buffer[22050].count)

    // Correct the first and last indices in `windowStop`.
    windowStop[0] = min(hopSize, windowMax)
    windowStop[frameCount-1] = min(windowStop[frameCount-1], windowMax)

    // Iterate the three different sample rates.
    for sampleRate: SampleRate in [882, 4410, 22050] {

      // Get the signal for this sample rate.
      let x = buffer[sampleRate]

      // Get the length of the signal.
      let l = x.count

      // Get the sample rate as a `Float` value.
      let Fs = Float(sampleRate.rawValue)

      // Allocate memory for two addition buffers of data. The second buffer is neccesary
      // for the forward-backward filter implementation and zero-phase filter result.
      var y = SignalVector(count: l)

      // Calculate the factor by which the sum of squares will need to be multiplied.
      let factor = 22050/Float64(sampleRate.rawValue)

      // Iterate through the pitches that correspond to this sample rate.
      for pitch in sampleRate.pitchRange {

        // Use the pitch's raw value for indexing purposes.
        let p = pitch.rawValue

        filters[p]?.process(signal: x, y: &y)

        let delay = filterDelays[p]

        if delay > 0 {

          let copyCount = vDSP_Length(l - delay)
          vDSP_mmovD(y.storage, y.storage + delay, copyCount, 1, copyCount, copyCount)

          vDSP_vclrD(y.storage, 1, vDSP_Length(delay))

        }

        // Iterate through each frame using filtered signal `y` to calculate STMSP.
        for frame in 0..<frameCount {

          let start = Int(((windowStart[frame]/22050)*Fs).rounded(.up))
          let end = Int(((windowStop[frame]/22050)*Fs).rounded(.down))


          // Create a double value for holding the sum.
          var sum: Float64 = 0

          // Calculate the sum of the squared values from `offset` to `frameSampleCount`.
          vDSP_svesqD(y.storage + start, 1, &sum, vDSP_Length(start.distance(to: end)))

          // Store the sum in the result to be returned.
          stmspFrames[frame][p] = sum * factor
        }

      }

    }

    // Calculate the feature rate using the top level sample rate.
    let featureRate = 22050/Float(windowSize - hopSize)

    return PitchBuffer(buffer: stmspFrames, frameCount: frameCount, featureRate: featureRate)

  }

}

private let filterCoefficients: [(a: [Float64], b: [Float64])] = [
    (a: [], b: []),
    (a: [], b: []),
    (a: [], b: []),
    (a: [], b: []),
    (a: [], b: []),
    (a: [], b: []),
    (a: [], b: []),
    (a: [], b: []),
    (a: [], b: []),
    (a: [], b: []),
    (a: [], b: []),
    (a: [], b: []),
    (a: [], b: []),
    (a: [], b: []),
    (a: [], b: []),
    (a: [], b: []),
    (a: [], b: []),
    (a: [], b: []),
    (a: [], b: []),
    (a: [], b: []),
    (a: [], b: []),
    (a: [1.0, -7.8397125566975401, 27.040510993150502, -53.590470586269198, 66.744129192255897, -53.491379562038503, 26.940605406679001, -7.7963050922035402, 0.99262433569337005], b: [0.0031517979535353002, -0.024727352939516101, 0.085356188563273899, -0.169306632979488, 0.211052005541844, -0.169306632979488, 0.085356188563273899, -0.024727352939516101, 0.0031517979535353002]),
    (a: [1.0, -7.8206265083942696, 26.927985683195001, -53.3113267851625, 66.370845562661003, -53.206896068828399, 26.8225914438259, -7.7747574251552596, 0.99218747389046003], b: [0.0031512517104749799, -0.024663659877994501, 0.084992205663669801, -0.168414905495119, 0.20987022667388699, -0.16841490549511801, 0.084992205663669704, -0.024663659877994501, 0.00315125171047497]),
    (a: [1.0, -7.7992501056366503, 26.802308076833299, -53.000123982319003, 65.955096209650904, -52.890135740863499, 26.6911808450464, -7.7507947990312198, 0.99172484477313405], b: [0.0031506823679747602, -0.0245925915500891, 0.084586303916510494, -0.167421389633959, 0.208554006712421, -0.167421389633959, 0.084586303916510397, -0.024592591550088999, 0.0031506823679747502]),
    (a: [1.0, -7.7753093732118703, 26.661989034071102, -52.6533572558195, 65.492304600514998, -52.537598313070198, 26.544884653295501, -7.7241398162062396, 0.99123494173030302], b: [0.0031500896945190699, -0.024513283191092802, 0.084133780120015003, -0.16631500219055101, 0.20708885792283399, -0.16631500219055101, 0.084133780120015003, -0.024513283191092802, 0.0031500896945190699]),
    (a: [1.0, -7.74849811525878, 26.505385541374501, -52.267190291588101, 64.977476256240493, -52.145455374325998, 26.382062609858799, -7.6944833839000504, 0.99071617167774195], b: [0.0031494735834170502, -0.024424769618671401, 0.083629448835788905, -0.16508361649582501, 0.205458969809623, -0.16508361649582501, 0.083629448835789003, -0.024424769618671498, 0.0031494735834170602]),
    (a: [1.0, -7.7184742889336402, 26.330688881405301, -51.837438163362997, 64.405181103656503, -51.709533791768102, 26.200911894423399, -7.6614812509870003, 0.99016685029363705], b: [0.0031488340769664398, -0.024325974046712301, 0.083067605820310295, -0.16371400895802901, 0.203647153365033, -0.16371400895802901, 0.083067605820310295, -0.024325974046712301, 0.0031488340769664398]),
    (a: [1.0, -7.6848560140847599, 26.135913077783499, -51.359553434752002, 63.769541306973899, -51.225302547096298, 25.9994562321024, -7.62475021379531, 0.98958519701668402], b: [0.0031481713940631501, -0.024215695789316798, 0.082441992442537596, -0.16219181626208901, 0.20163480269525699, -0.16219181626208901, 0.082441992442537707, -0.024215695789316798, 0.0031481713940631501]),
    (a: [1.0, -7.6472171945779701, 25.918884061653799, -50.828617164155602, 63.064226846021803, -50.6878645706783, 25.775535824063098, -7.5838639723935897, 0.98896932979766095], b: [0.0031474859617001499, -0.0240925967824367, 0.081745762508134395, -0.16050150823901799, 0.19940188120906899, -0.16050150823901799, 0.081745762508134298, -0.0240925967824367, 0.0031474859617001399]),
    (a: [1.0, -7.60508272900314, 25.677230155494801, -50.239336801482303, 62.282461657218299, -50.091955564820999, 25.526798706471599, -7.5383486218802398, 0.98831725959591898], b: [0.0031467784508537899, -0.023955186857330599, 0.080971453378296407, -0.158626382704875, 0.196926941292211, -0.158626382704875, 0.080971453378296407, -0.023955186857330599, 0.0031467784508537899]),
    (a: [1.0, -7.5579232920865902, 25.408374655637601, -49.5860534453426, 61.417043788092599, -49.431952283340898, 25.250694327043, -7.4876777678285098, 0.98762688461268799], b: [0.00314604981731641, -0.0238018077112883, 0.080110963855268599, -0.15654859008134001, 0.19418718840176, -0.15654859008134001, 0.080110963855268696, -0.023801807711288401, 0.00314604981731642]),
    (a: [1.0, -7.5051496737192096, 25.109531525882598, -48.862761482787299, 60.460383735104998, -48.701893282101899, 24.944470356704301, -7.4312672617796496, 0.98689598425276104], b: [0.0031453013481023001, -0.023630615538395398, 0.079155542030610801, -0.15424919735289899, 0.19115860279216501, -0.15424919735289899, 0.079155542030610801, -0.023630615538395398, 0.0031453013481022901]),
    (a: [1.0, -7.4461066706987404, 24.777705498840199, -48.063144256977203, 59.404565927237897, -47.8955157703003, 24.605174033719798, -7.3684695621411702, 0.98612221280738399], b: [0.0031445347141302198, -0.023439562308311401, 0.078095787182020995, -0.15170830287638001, 0.18781613459538599, -0.15170830287638001, 0.078095787182020995, -0.023439562308311401, 0.0031445347141302198]),
    (a: [1.0, -7.3800665378408397, 24.4096982283247, -47.180630088424103, 58.241439161081303, -47.006312861320403, 24.229659677526101, -7.2985677387711299, 0.98530309285075401], b: [0.0031437520299709802, -0.023226375716423098, 0.076921670888162902, -0.148905215695432, 0.18413399064813499, -0.148905215695432, 0.076921670888162805, -0.023226375716423001, 0.0031437520299709698]),
    (a: [1.0, -7.3062220209997104, 24.002122554803201, -46.208473685630501, 56.9627426455868, -46.027616217306402, 23.814604418230399, -7.2207691568700803, 0.98443600834411005], b: [0.00314295592154357, -0.022988537877164102, 0.0756225838374293, -0.145818715238864, 0.180086034158006, -0.145818715238864, 0.075622583837429203, -0.022988537877164102, 0.00314295592154357]),
    (a: [1.0, -7.2236790159409301, 23.5514274457162, -45.139868673063503, 55.560275109672098, -44.952709754493597, 23.3565346732614, -7.1341988986855203, 0.98351819744152702], b: [0.0031421496027502099, -0.022723262897321499, 0.074187416363632894, -0.14242740944506199, 0.17564632081602199, -0.14242740944506299, 0.074187416363633005, -0.022723262897321499, 0.0031421496027502199]),
    (a: [1.0, -7.1314489253989199, 23.053936761184499, -43.968097560708003, 54.026115063863898, -43.774980648516802, 22.851866471512398, -7.03789301137944, 0.98254674499314498], b: [0.0031413369621593299, -0.0224274735521592, 0.072604682572258106, -0.13871021120829199, 0.17078979697958499, -0.13871021120829199, 0.072604682572258106, -0.0224274735521592, 0.0031413369621593299]),
    (a: [1.0, -7.0284408238279799, 22.505905677761302, -42.686725860669597, 52.352900646558297, -42.488114230715397, 22.296963380335502, -6.9307917079029702, 0.98151857474233195], b: [0.0031405226609790499, -0.022097777399540899, 0.070862700037819595, -0.13464695420901099, 0.16549318661752899, -0.13464695420901199, 0.070862700037819804, -0.022097777399541, 0.0031405226609790698]),
    (a: [1.0, -6.9134535875141401, 21.903599377256601, -41.289847047147198, 50.534177334592798, -41.086339322805202, 21.688216528775001, -6.8117326969190897, 0.98043044121497402], b: [0.003139712243712, -0.021730442812469799, 0.068949839450367895, -0.13021916911553499, 0.15973609321912799, -0.13021916911553499, 0.0689498394503677, -0.021730442812469698, 0.0031397122437119801]),
    (a: [1.0, -6.78516820950317, 21.2433994633917, -39.772384407755403, 48.564820909094202, -39.564729870448403, 21.022152028280701, -6.6794448801477797, 0.97927892130108196], b: [0.0031389122630491599, -0.0213213755964652, 0.066854861231069804, -0.125411039043509, 0.15350234003509899, -0.125411039043509, 0.066854861231069707, -0.0213213755964651, 0.0031389122630491499]),
    (a: [1.0, -6.6421405973869296, 20.521944480188299, -38.130454204712997, 46.441541138223101, -37.9195670669097, 20.295571941275501, -6.5325427338454896, 0.97806040553041096], b: [0.0031381304207458698, -0.0208660970944115, 0.064567358939395997, -0.12021054795573601, 0.146781565878497, -0.12021054795573601, 0.064567358939396094, -0.0208660970944115, 0.0031381304207458798]),
    (a: [1.0, -6.4827952511242, 19.7363118238966, -36.361791499114403, 44.163468323520597, -36.148763056415099, 19.505735786999001, -6.3695217888268303, 0.97677108904690102], b: [0.0031373757264315798, -0.020359724979122602, 0.062078332102914698, -0.114610825947773, 0.139571083169271, -0.114610825947773, 0.062078332102914802, -0.020359724979122699, 0.0031373757264315902]),
    (a: [1.0, -6.3054203421245596, 18.884249183152502, -34.4662349068265, 41.732819802313699, -34.252342197931597, 18.650590318632201, -6.1887557442935899, 0.97540696228880597], b: [0.0031366586765372499, -0.0197969583059441, 0.059380913656715197, -0.10861167926247001, 0.13187798883087401, -0.10861167926247001, 0.059380913656715301, -0.0197969583059442, 0.0031366586765372599]),
    (a: [1.0, -6.1081648688071102, 17.964464281277699, -32.446258733565202, 39.155636408954798, -32.232968050354899, 17.729055825257099, -5.9884958990481403, 0.97396380138549299], b: [0.00313599145578479, -0.0191720688592899, 0.056471279078706998, -0.102221268162812, 0.123721496093122, -0.102221268162812, 0.056471279078707103, -0.019172068859290001, 0.0031359914557848099]),
    (a: [1.0, -5.8890387533736703, 16.976981936806698, -30.307529547389699, 36.4425696468955, -30.096492897581701, 16.741377312823101, -5.7668737640540497, 0.97243715828463495], b: [0.0031353881639744601, -0.018478901395028301, 0.053349764943966198, -0.095457859867186107, 0.11513542581164, -0.095457859867186204, 0.053349764943966302, -0.018478901395028301, 0.0031353881639744601]),
    (a: [1.0, -5.6459169757083396, 15.923577023089001, -28.059448403373601, 33.609689132151097, -27.852490909481201, 15.689548321899, -5.5219079376174003, 0.97082235062884903], b: [0.0031348650711326702, -0.0177108860736305, 0.050022223120804697, -0.088351533857111406, 0.106170760261713, -0.088351533857111197, 0.050022223120804503, -0.017710886073630399, 0.0031348650711326498]),
    (a: [1.0, -5.3765491194600896, 14.8082904011496, -25.715618829875002, 30.6792675511246, -25.5147151633935, 14.577813459499, -5.2515165833689199, 0.96911445140478203], b: [0.0031344409044489598, -0.0168610672164888, 0.0465016319668934, -0.080945650509728004, 0.096898123062171396, -0.080945650509728101, 0.046501631966893497, -0.0168610672164888, 0.0031344409044489702]),
    (a: [1.0, -5.07857603859562, 13.638031784475899, -23.294153833080799, 27.680488658836001, -23.101392294269701, 13.413252434722599, -4.9535371557890899, 0.96730827839395495], b: [0.0031341371708418502, -0.015922153519078601, 0.042809975986880203, -0.073297809725140495, 0.087410011377325195, -0.073297809725140398, 0.042809975986880203, -0.015922153519078601, 0.0031341371708418402]),
    (a: [1.0, -4.7495557451744999, 12.4232680589918, -20.817702821100301, 24.650015715893101, -20.6352368025386, 12.2064428081932, -4.6257553707797499, 0.96539838346035201], b: [0.0031339785194551099, -0.014886596036747, 0.038980388281268999, -0.065479924872754905, 0.077822580272522895, -0.065479924872754794, 0.038980388281268902, -0.014886596036747, 0.0031339785194551099]),
    (a: [1.0, -4.3870010738298602, 11.1787869173271, -18.3130431024261, 21.632357756174802, -18.143031698338898, 10.9721899271112, -4.2659458196279401, 0.96337904171758304], b: [0.0031339931489058098, -0.0137467016335377, 0.035059522941776999, -0.057576924154197601, 0.068276778395672394, -0.057576924154197601, 0.035059522941776999, -0.013746701633537599, 0.0031339931489058098]),
    (a: [1.0, -3.9884321945966201, 9.9245126592325992, -15.810044381939999, 18.679985273396198, -15.6545871504486, 9.7302995729012096, -3.8719270689965302, 0.96124424062564195], b: [0.0031342132646907201, -0.012494791153144801, 0.0311100838973822, -0.049683478786988998, 0.058938678282737397, -0.049683478786988998, 0.0311100838973822, -0.0124947911531447, 0.0031342132646907102]),
    (a: [1.0, -3.5514476160526698, 8.6863323672825405, -13.3397859194967, 15.853182308750799, -13.200861599841801, 8.5063505022399593, -3.4416345656927501, 0.95898766907719901], b: [0.0031346755928191002, -0.011123413318097901, 0.027213378618266899, -0.041898068829751403, 0.049998955734314697, -0.041898068829751403, 0.027213378618266799, -0.011123413318097901, 0.0031346755928190898]),
    (a: [1.0, -3.0738179278912701, 7.4968650097295102, -10.931597299779, 13.2196845770852, -10.8110228713804, 7.3323990732781397, -2.9732151507219502, 0.95660270654281698], b: [0.0031354219564873899, -0.00962562724552086, 0.023471685324396498, -0.034313672582201797, 0.041671670205831901, -0.034313672582201797, 0.023471685324396401, -0.0096256272455208392, 0.00313542195648737]),
    (a: [1.0, -2.5536071435326302, 6.3960720830503401, -8.6088244333087296, 10.854244495438699, -8.5082592641345496, 6.24751543465797, -2.46514744505071, 0.95408241235611702], b: [0.0031364999234594799, -0.0079953684004554996, 0.020010117074622798, -0.027004465049991301, 0.034192786399996997, -0.027004465049991301, 0.020010117074622798, -0.0079953684004554996, 0.0031364999234594799]),
    (a: [1.0, -1.98932706463733, 5.4315653954921004, -6.3832198905730797, 8.8383737115166507, -6.3042493194665203, 5.2980097603326701, -1.9163927404269501, 0.95141951523262402], b: [0.0031379635327798902, -0.0062279146446483601, 0.016977532990447599, -0.0200082208220182, 0.027819224850587399, -0.0200082208220182, 0.016977532990447599, -0.00622791464464838, 0.0031379635327799002]),
    (a: [1.0, -1.3801305145541001, 4.6584158116715999, -4.24805643840687, 7.2606106660363503, -4.1923985051741202, 4.5371583154969501, -1.3265812235450301, 0.94860640312982003], b: [0.0031398741105461299, -0.0043204705458787501, 0.014545886959480401, -0.013304747539919301, 0.02282953790009, -0.013304747539919301, 0.0145458869594803, -0.0043204705458787197, 0.0031398741105461]),
    (a: [1.0, -0.72604944780260094, 4.1382085781883999, -2.1704051952957801, 6.2176800451442098, -2.1402904542528902, 4.0241853747749801, -0.69623825172982501, 0.945635113571624], b: [0.0031423011857232598, -0.0022728889338778, 0.0129072248863801, -0.0067917536515662898, 0.019527373065983799, -0.0067917536515662898, 0.0129072248863801, -0.0022728889338778, 0.0031423011857232598]),
    (a: [1.0, -0.028283650629519701, 3.9370320297941199, -0.083542033811039404, 5.8167434589456599, -0.082314491785103305, 3.8222042088005299, -0.027054801694626401, 0.94249732457769198], b: [0.0031453235184254798, -8.8548300376874598e-05, 0.012267360987523301, -0.000261191668231923, 0.0182483641949064, -0.00026119166823192501, 0.012267360987523301, -8.8548300376877295e-05, 0.0031453235184254499]),
    (a: [1.0, 0.71045525929924003, 4.1220381812229396, 2.1188367580871001, 6.1784322391999602, 2.0858670435426099, 3.9947796964170901, 0.67779511795092795, 0.93918434635691905], b: [0.0031490302547504201, 0.0022245977016674199, 0.012835116320780699, 0.0066186393254274601, 0.0193694962772939, 0.0066186393254274696, 0.012835116320780699, 0.0022245977016674299, 0.0031490302547504401]),
    (a: [1.0, 1.48554190630691, 4.7561947953189403, 4.5840326566645402, 7.4393319031068401, 4.5084978735564301, 4.6007650996320297, 1.4132896933672401, 0.93568711394520498], b: [0.0031535222241719399, 0.0046527877304748597, 0.0148059469814994, 0.014307220558673801, 0.0233167800327377, 0.014307220558673801, 0.0148059469814994, 0.0046527877304748597, 0.0031535222241719498]),
    (a: [1.0, -7.4374987276139803, 24.729549974287099, -47.947406810048797, 59.251899764542202, -47.778857067079798, 24.555991929862198, -7.3593391322946999, 0.986012841327085], b: [0.0031444284886285, -0.023411746004325999, 0.077942080799166202, -0.151340621773178, 0.18733283254553701, -0.151340621773178, 0.077942080799166299, -0.023411746004326099, 0.0031444284886285099]),
    (a: [1.0, -7.3704400113886903, 24.356331306218301, -47.053025057578601, 58.0734443623397, -46.877802066188003, 24.175265864191601, -7.2884051256710896, 0.98518731451036901], b: [0.0031436437997640599, -0.023195340053373301, 0.076751499507004203, -0.14850000730407001, 0.18360216818219399, -0.14850000730407001, 0.076751499507004398, -0.023195340053373401, 0.0031436437997640699]),
    (a: [1.0, -7.2954598397047903, 23.943067201919199, -46.068070201710498, 56.7782888861502, -45.886334005766003, 23.7545316499648, -7.2094596266664004, 0.98431345392631797], b: [0.0031428460899354201, -0.0229539179137308, 0.075434454235787804, -0.14537305257123001, 0.17950211527439999, -0.14537305257123001, 0.075434454235787596, -0.0229539179137307, 0.0031428460899354002]),
    (a: [1.0, -7.2116516328121802, 23.486186864534499, -44.985738256726101, 55.358256101474197, -44.797741102331997, 23.2902978630094, -7.1216159333199798, 0.98338847719705802], b: [0.0031420386600223898, -0.022684655214005499, 0.073979775387189695, -0.141938376211207, 0.17500680622863299, -0.141938376211206, 0.073979775387189597, -0.022684655214005499, 0.0031420386600223898]),
    (a: [1.0, -7.1180132539612497, 22.982000974570699, -43.799337929980503, 53.805483146965599, -43.6054387641476, 22.778969486414699, -7.02389737743861, 0.98240944759092796], b: [0.0031412254982835998, -0.022384433006310801, 0.072375938150472496, -0.138174977390251, 0.17009137375802899, -0.138174977390251, 0.072375938150472302, -0.022384433006310701, 0.0031412254982835799]),
    (a: [1.0, -7.01343915887258, 22.426760870409399, -42.502491308094697, 52.112710190715703, -42.303171011308898, 22.216908578834101, -6.9152305314892102, 0.98137326617766196], b: [0.00314041137997975, -0.022049813837148099, 0.070611250867200701, -0.13406287236567499, 0.16473286573545801, -0.13406287236567399, 0.070611250867200603, -0.022049813837148002, 0.00314041137997974]),
    (a: [1.0, -6.8967125366123803, 21.816740689403701, -41.0893862704878, 50.273638034793997, -40.885263194860798, 21.600517715546101, -6.7944385731556496, 0.98027666367551702], b: [0.00313960197988143, -0.021677017815908899, 0.068674115513721101, -0.129583894184265, 0.158911378439373, -0.129583894184265, 0.068674115513721101, -0.021677017815908899, 0.00313960197988143]),
    (a: [1.0, -6.7664976710153004, 21.148348054556699, -39.555086522087201, 48.283361863794802, -39.346931713861999, 20.926351618166301, -6.6602350556404399, 0.979116191990822], b: [0.00313880399924279, -0.021261899376548699, 0.066553377698017696, -0.12472267390337299, 0.15261143093888599, -0.12472267390337299, 0.066553377698017599, -0.021261899376548599, 0.00313880399924279]),
    (a: [1.0, -6.6213328329593502, 20.418269807345698, -37.895903340680697, 46.1388862352077, -37.684654593215498, 20.191263240306601, -6.5112184125711297, 0.97788821545204296], b: [0.0031380253090119402, -0.0207999256719021, 0.064238786382045193, -0.11946781598897099, 0.14582359668859399, -0.11946781598897099, 0.064238786382045304, -0.0207999256719021, 0.0031380253090119502]),
    (a: [1.0, -6.4596241160700698, 19.6236602006087, -36.109829830174398, 43.839722876925798, -35.896603445658499, 19.392591408464501, -6.3458676270001302, 0.97658890174346102], b: [0.0031372751112594701, -0.020286157847091198, 0.061721586332578002, -0.11381327005427801, 0.138546397167785, -0.11381327005427699, 0.061721586332577898, -0.020286157847091198, 0.0031372751112594601]),
    (a: [1.0, -6.2796407562695302, 18.762379789261299, -34.197033057101997, 41.388567539488101, -33.983131905728897, 18.528397840137998, -6.1625396183401397, 0.97521421254584395], b: [0.0031365641210431899, -0.019715236821875301, 0.058995268797513302, -0.107759883963412, 0.130788445485123, -0.107759883963412, 0.058995268797513399, -0.019715236821875301, 0.0031365641210431899]),
    (a: [1.0, -6.0795126340894097, 17.833293854612901, -32.160391189599899, 38.7920447670014, -31.947307371525898, 17.5977618364808, -5.9594690534970702, 0.973759893895349], b: [0.0031359047711914398, -0.0190813756868921, 0.056056507672037903, -0.101317097236165, 0.12257080437923799, -0.101317097236165, 0.056056507672037903, -0.0190813756868921, 0.0031359047711914498]),
    (a: [1.0, -5.8572308535263398, 16.8366393663186, -30.0060508114946, 36.061499910935296, -29.795460998574502, 16.601140970626499, -5.7347714736181503, 0.97222146627531303], b: [0.0031353114427832901, -0.018378361402738699, 0.052906308822119601, -0.094504696015599604, 0.11392949267920501, -0.094504696015599604, 0.052906308822119601, -0.018378361402738599, 0.0031353114427832901]),
    (a: [1.0, -5.6106525285805198, 15.7744689302863, -27.743963064151298, 33.213806300435699, -27.537714504049301, 15.5408053736596, -5.4864508506037604, 0.97059421446017202], b: [0.0031348007244358799, -0.017599569202451301, 0.049551398353253701, -0.087354498846949402, 0.104918037932381, -0.087354498846949402, 0.049551398353253701, -0.017599569202451301, 0.0031348007244358898]),
    (a: [1.0, -5.3375111948174903, 14.6511784793336, -25.388335394266999, 30.272143120850401, -25.1884207181695, 14.421351354042899, -5.2124129524747902, 0.96887317713564103], b: [0.00313439170388109, -0.0167379939567373, 0.046005870168878998, -0.079911773755910895, 0.095609933451090701, -0.079911773755910895, 0.046005870168878998, -0.0167379939567373, 0.00313439170388109]),
    (a: [1.0, -5.0354346043586498, 13.474122076575201, -22.957908042679101, 27.266688117641401, -22.766427599266599, 13.2502965294085, -4.9104862077368399, 0.96705313632487999], b: [0.0031341062957313099, -0.015786303786405401, 0.042293102418836798, -0.072236100373687995, 0.086100821399841307, -0.072236100373688106, 0.042293102418836999, -0.015786303786405501, 0.0031341062957313298]),
    (a: [1.0, -4.7019720635800102, 12.254311382541401, -20.4759313858853, 24.235161922478401, -20.2950430568863, 12.038752692954001, -4.5784521183147797, 0.96512860665704603], b: [0.0031339696098034399, -0.014736922414371899, 0.038447934112071501, -0.064401287450987804, 0.076510199809186705, -0.064401287450987693, 0.038447934112071397, -0.014736922414371899, 0.0031339696098034199]),
    (a: [1.0, -4.3346339360987702, 11.0071881487562, -17.969683701924598, 21.223162345470801, -17.8015423256508, 10.8021633885418, -4.2140876778151002, 0.96309382452152903], b: [0.0031340103648984001, -0.0135821481510238, 0.034519064365201198, -0.056493842012124297, 0.066982455598044194, -0.056493842012124297, 0.034519064365201198, -0.0135821481510238, 0.0031340103648983902]),
    (a: [1.0, -3.9309464578105402, 9.7534444015709791, -15.4693331858895, 18.284243656332201, -15.3160251537631, 9.5610795575573206, -3.8152227014040601, 0.96094273715963796], b: [0.00313426135352867, -0.0123143190012197, 0.030571593964018699, -0.048609375309601598, 0.057687077655534102, -0.048609375309601598, 0.030571593964018699, -0.012314319001219799, 0.00313426135352868]),
    (a: [1.0, -3.48852558740646, 8.5198454589215498, -13.005921148231, 15.479734699941799, -12.869404768556899, 8.3419274377224504, -3.3798154526181099, 0.95866899175457199], b: [0.0031347599637587598, -0.010926035150044399, 0.026689568102179002, -0.040846248114636302, 0.048818026033095797, -0.040846248114636302, 0.026689568102179002, -0.010926035150044399, 0.0031347599637587598]),
    (a: [1.0, -3.0051742258782199, 7.3399842008135803, -10.608238690158601, 12.878356351370099, -10.4903077504766, 7.1776969046553996, -2.9060504369969702, 0.95626592459069104], b: [0.0031355487650838801, -0.0094104519797177707, 0.0229782961175992, -0.033295745903662299, 0.0405924434920703, -0.033295745903662299, 0.0229782961175992, -0.0094104519797177499, 0.0031355487650838701]),
    (a: [1.0, -2.4790077469497001, 6.2548598633350201, -8.2984071562752995, 10.5557935273876, -8.2007036932537893, 6.1084446144748901, -2.3924626825072099, 0.95372655036493503], b: [0.0031366761661353001, -0.0077616586998968699, 0.019566115050368899, -0.026028197181725801, 0.033249195004212598, -0.026028197181725801, 0.019566115050368801, -0.00776165869989685, 0.0031366761661352801]),
    (a: [1.0, -1.9086133289038101, 5.3131303625281499, -6.0860818879257002, 8.5944874191974403, -6.0101938527610601, 5.1814641879902199, -1.83809317959833, 0.95104355174558097], b: [0.0031381971529815, -0.0059751594815447397, 0.016605126889132099, -0.019074794936943602, 0.0270480708193254, -0.019074794936943501, 0.016605126889132099, -0.0059751594815447302, 0.0031381971529815]),
    (a: [1.0, -1.29324897591101, 4.5708342954006502, -3.9614156758043602, 7.0840046547718103, -3.9091043335934299, 4.4509260701386602, -1.2426803155842201, 0.948209269288255], b: [0.0031401741179137798, -0.0040484754220915997, 0.0142702761877514, -0.012405565650827399, 0.022270778961835901, -0.012405565650827399, 0.0142702761877514, -0.0040484754220915901, 0.0031401741179137698]),
    (a: [1.0, -0.63308822770019202, 4.0903200402683098, -1.8872835119714799, 6.12234137814057, -1.8608908708547001, 3.9767356144411101, -0.60689197339362999, 0.94521569183452803], b: [0.0031426777898846498, -0.0019818863602955902, 0.0127559539108768, -0.0059050785427905601, 0.019224861973136598, -0.0059050785427905601, 0.0127559539108768, -0.0019818863602955798, 0.0031426777898846399]),
    (a: [1.0, 0.070483816046842396, 3.9380611942476502, 0.20818097111234801, 5.8183160096703803, 0.20509793421438699, 3.82230599890483, 0.067397716085962595, 0.94205444753588596], b: [0.0031457882792377801, 0.000220669047078714, 0.012269134856795901, 0.00065079212219333203, 0.018251035668920501, 0.00065079212219333095, 0.012269134856796, 0.000220669047078713, 0.00314578827923781]),
    (a: [1.0, 0.81451866051344202, 4.1809919954382098, 2.43694409263871, 6.29463572002083, 2.3987260126387699, 4.0509048310641802, 0.77678443379909501, 0.93871679566537003], b: [0.00314959625106146, 0.0025505192574470999, 0.0130179171630403, 0.0076114176283193398, 0.019732663335621001, 0.0076114176283193103, 0.0130179171630402, 0.00255051925744707, 0.0031495962510614301]),
    (a: [1.0, 1.5940945349818201, 4.8809834898528699, 4.9516425266127104, 7.6901186521756797, 4.8694081049970803, 4.7202294152566697, 1.5159625798254299, 0.93519361939981205], b: [0.0031542042434569398, 0.0049930018871855598, 0.0151942953598821, 0.015452874686645199, 0.0241026118421237, 0.015452874686645199, 0.015194295359881999, 0.0049930018871855303, 0.0031542042434569099]),
    (a: [1.0, 2.4018501152170102, 6.0871317119466397, 7.93779845416464, 10.157825439529701, 7.7981995639445101, 5.8749251008136598, 2.27731118298852, 0.93147541977880299], b: [0.00315972814928869, 0.00752602239337344, 0.0189501578477618, 0.024753178723956701, 0.031837299068883898, 0.0247531787239566, 0.0189501578477618, 0.0075260223933734296, 0.00315972814928869]),
    (a: [1.0, 3.2274696282108501, 7.8256861984876096, 11.593554256918701, 13.8536603875325, 11.3776445205571, 7.5369245561628704, 3.05044717106126, 0.92755231107179303], b: [0.0031662988826379702, 0.0101184467903849, 0.0243659883912773, 0.036128465593559797, 0.043420842610472597, 0.036128465593559797, 0.024365988391277099, 0.0101184467903849, 0.0031662988826379398]),
    (a: [1.0, 4.0571362565784597, 10.087766008155199, 16.093110548143699, 18.908021103087801, 15.7757419686594, 9.6938041388298508, 3.82176527065455, 0.92341401781157795], b: [0.00317406425429049, 0.0127283714592526, 0.031412739237305698, 0.050118345868311598, 0.059255992287540603, 0.050118345868311702, 0.031412739237305698, 0.0127283714592526, 0.0031740642542905]),
    (a: [1.0, 4.8729837792961197, 12.815553241893401, 21.532000897371798, 25.3727877923784, 21.082357002532, 12.285882185577499, 4.5739960982306496, 0.91904987378224401], b: [0.00318319108424792, 0.0153013503401604, 0.039909021957116701, 0.067014852365736496, 0.079497650964106104, 0.067014852365736496, 0.039909021957116798, 0.0153013503401604, 0.00318319108424793]),
    (a: [1.0, 5.6525942040152701, 15.888475785690201, 27.856822587253099, 33.139752976186003, 27.240844174981799, 15.193568615255, 5.2858303190062799, 0.91444882328108001], b: [0.0031938675835758998, 0.017768711714926999, 0.0494783001754249, 0.086643516403014903, 0.103796838368635, 0.086643516403015097, 0.049478300175425101, 0.0177687117149271, 0.0031938675835759302]),
    (a: [1.0, 6.3686125807205398, 19.112010821548601, 34.789744693174498, 41.837352051726697, 33.975188361523699, 18.227523657419901, 5.9316775413346496, 0.90959942500786795], b: [0.0032063060430323502, 0.020046166504322799, 0.059514225795971702, 0.10812920562968401, 0.130976919400872, 0.10812920562968401, 0.059514225795971702, 0.020046166504322799, 0.0032063060430323601]),
    (a: [1.0, 8.7589464733743796, 35.586515109765699, 88.091587704837494, 146.92294117141401, 172.38162283223099, 144.05510905981001, 84.686206335670605, 33.543111964144003, 8.0948841736208195, 0.90615530991327597], b: [0.00096673725231487696, 0.0067871983729406796, 0.0207529465480032, 0.034425767481034902, 0.028910368721451599, -1.4940251871457101e-16, -0.0289103687214519, -0.034425767481035, -0.0207529465480032, -0.00678719837294067, -0.00096673725231487305]),
    (a: [1.0, 9.3701900676271901, 40.014915876122203, 102.511797656539, 174.41910699116301, 205.91436029156799, 170.81397535232401, 98.317984097895305, 37.584759880969102, 8.6192764829597994, 0.90086141601477199], b: [0.00102323374378487, 0.0076822600538210498, 0.024688846836865501, 0.042392181189398498, 0.0363308058052524, 3.6334388898956703e-15, -0.036330805805246301, -0.042392181189395001, -0.024688846836864099, -0.0076822600538207298, -0.0010232337437848301]),
    (a: [1.0, -6.6002153878757603, 20.3133852992732, -37.658972317346297, 45.833328944933001, -37.447382857479298, 20.085762433963801, -6.4895883166939301, 0.97771468944103701], b: [0.0031379207286704202, -0.020732784715783301, 0.063906415267506997, -0.118717586752487, 0.144856445568187, -0.118717586752487, 0.0639064152675069, -0.020732784715783301, 0.0031379207286704098]),
    (a: [1.0, -6.4361108846576203, 19.5097582119501, -35.855490303689002, 43.513124393454497, -35.6420903775225, 19.278218168058299, -6.3218769137698798, 0.97640530287861904], b: [0.00313717522787515, -0.020211520810334602, 0.061360918658493198, -0.113008230163433, 0.13751268694676899, -0.113008230163433, 0.061360918658493101, -0.020211520810334602, 0.0031371752278751401]),
    (a: [1.0, -6.25348404336198, 18.639238214753501, -33.925506400199097, 41.041585107429697, -33.711624762253599, 18.404958702864398, -6.1359538691829298, 0.97501997157375997], b: [0.0031364705298693499, -0.0196323370340034, 0.0586056379767411, -0.106900778768694, 0.12969026859546801, -0.106900778768694, 0.0586056379767411, -0.0196323370340034, 0.00313647052986934]),
    (a: [1.0, -6.0504456357532801, 17.700855007541399, -31.872313138964699, 38.425934225205602, -31.659467613556501, 17.4652290959481, -5.9300372748134498, 0.97355441128384401], b: [0.0031358193199002302, -0.0189893878102988, 0.055637767022992703, -0.10040598441478001, 0.121412149867308, -0.10040598441478001, 0.055637767022992599, -0.0189893878102987, 0.0031358193199002198]),
    (a: [1.0, -5.8249680351219197, 16.6950660161854, -29.702547257929702, 35.678226133960301, -29.492438921818302, 16.4597076133056, -5.7022268414335002, 0.972004110837553], b: [0.0031352362651771702, -0.018276402567835699, 0.052459006926163197, -0.093545184048357197, 0.112716595596772, -0.093545184048357294, 0.052459006926163197, -0.018276402567835699, 0.0031352362651771702]),
    (a: [1.0, -5.5748906819266999, 15.6242114579104, -27.426718584678198, 32.816152533139103, -27.221216340878001, 15.390950593551599, -5.4505121623116901, 0.97036432194670597], b: [0.0031347382783637398, -0.017486702191674301, 0.049076988873851, -0.086351962257221401, 0.10365972490299701, -0.086351962257221401, 0.049076988873850903, -0.017486702191674201, 0.0031347382783637298]),
    (a: [1.0, -5.29793139368092, 14.4930538565534, -25.059643852248801, 29.863812180935302, -24.8607575863557, 14.2639171993969, -5.17278699754889, 0.96863004879790204], b: [0.0031343448138670001, -0.016613233096170799, 0.045506958224364902, -0.078873511458899703, 0.094317941999265603, -0.078873511458899703, 0.045506958224364902, -0.016613233096170701, 0.0031343448138669901]),
    (a: [1.0, -4.9917053287308102, 13.3094047437994, -22.6206903574754, 26.852387106750999, -22.4305315235645, 13.086575579835801, -4.8668713156000996, 0.96679603745492804], b: [0.0031340782008849699, -0.015648624357987299, 0.041773727598491697, -0.071171390242441707, 0.084790066337875905, -0.071171390242441901, 0.041773727598491898, -0.0156486243579874, 0.0031340782008849998]),
    (a: [1.0, -4.6537538229077704, 12.0848350623309, -20.1337007144129, 23.820661648517, -19.954430540479802, 11.870585616154001, -4.5305431945229602, 0.96485676510882401], b: [0.00313396401764996, -0.0145852745818804, 0.037913886974381403, -0.063321275011907402, 0.075198958502471006, -0.063321275011907402, 0.037913886974381299, -0.0145852745818804, 0.00313396401764995]),
    (a: [1.0, -4.2815857898819596, 10.8354560530345, -17.626433200524101, 20.815323892871799, -17.460201028014399, 10.6320436466552, -4.1615830989312501, 0.96280642922038195], b: [0.00313403151184234, -0.0134154766000571, 0.033978228312315097, -0.055411185374601199, 0.065692447729424994, -0.055411185374601199, 0.033978228312315097, -0.0134154766000571, 0.00313403151184234]),
    (a: [1.0, -3.8727349080990998, 9.58274299306213, -15.1293170806804, 17.8910083919831, -14.978194990916499, 9.3922602649171907, -3.7578335031599899, 0.96063893660775401], b: [0.0031343140727545498, -0.0121315897258828, 0.030034297222116001, -0.0475375546983106, 0.056443427179143198, -0.0475375546983106, 0.030034297222116001, -0.0121315897258828, 0.0031343140727545498]),
    (a: [1.0, -3.42483639984437, 8.3543537258766598, -12.673297516320799, 15.1100813949755, -12.539222664559199, 8.1785222434275706, -3.31727731265488, 0.95834789254143704], b: [0.0031348497614687798, -0.0107262710725034, 0.026168920577454, -0.039798441377364602, 0.047649116288133599, -0.039798441377364602, 0.026168920577453899, -0.0107262710725034, 0.0031348497614687599]),
    (a: [1.0, -2.9357278203349599, 7.1848661143462804, -10.286544485660899, 12.5422405105896, -10.171287652038201, 7.0247626245925101, -2.83813901824684, 0.95592658991928203], b: [0.0031356819060853799, -0.0091927793535849997, 0.0224904725827446, -0.032283178476828003, 0.039529712477959299, -0.032283178476828003, 0.022490472582744499, -0.0091927793535849702, 0.0031356819060853699]),
    (a: [1.0, -2.4035788790381698, 6.1163221714951304, -7.9898460166697198, 10.264098700465199, -7.8950336666082199, 5.9720280610863501, -2.3190129590488402, 0.95336799860574395], b: [0.0031368597699173101, -0.00752536650751207, 0.019130529035119699, -0.025057906904721702, 0.032326964284913599, -0.025057906904721601, 0.019130529035119699, -0.0075253665075120197, 0.0031368597699172902]),
    (a: [1.0, -1.82705584953168, 5.1984211159615299, -5.79062768660099, 8.3590330257153695, -5.7178545643896701, 5.0685892600325904, -1.75902340279839, 0.95066475503282399], b: [0.0031384393015643601, -0.0057197742607532102, 0.016244418759739001, -0.018146823055204198, 0.026303548401163199, -0.018146823055204198, 0.016244418759739001, -0.0057197742607531998, 0.0031384393015643402]),
    (a: [1.0, -1.2055264918040201, 4.4881497112630599, -3.67577510073931, 6.9176624199117596, -3.62685325353022, 4.3694899237352001, -1.15802127870831, 0.94780915217421402], b: [0.0031404839769206801, -0.0037738541070375998, 0.014010014889563001, -0.011509712302264099, 0.021744400905788299, -0.011509712302264099, 0.014010014889563001, -0.0037738541070375998, 0.0031404839769206801]),
    (a: [1.0, -0.53931146864462798, 4.0485791148708996, -1.60382460792335, 6.0392998297747402, -1.58121933174699, 3.9352752972063998, -0.51682217517664397, 0.94479313002072995], b: [0.0031430657444736598, -0.0016883297291636801, 0.012623926656012601, -0.0050175608333671998, 0.018961098451767001, -0.0050175608333671903, 0.0126239266560125, -0.0016883297291636699, 0.0031430657444736399]),
    (a: [1.0, 0.17001222019738699, 3.9465001367932899, 0.50233687939376004, 5.83448011573347, 0.49483899045949897, 3.82959057344749, 0.162510555124906, 0.941608266702048], b: [0.0031462660867501799, 0.00053227994830741304, 0.0122940765962054, 0.0015701582118866899, 0.0182996231457206, 0.00157015821188668, 0.012294076596205499, 0.00053227994830740903, 0.0031462660867501899]),
    (a: [1.0, 0.91925152302327295, 4.2485262938896904, 2.7603544944994001, 6.4280327744553203, 2.7167236433256901, 4.1153049338169803, 0.87633532565005301, 0.93824577041983304], b: [0.0031501772124938598, 0.0028785619303405099, 0.0132275188531072, 0.0086205310779880195, 0.020149860254716101, 0.0086205310779880195, 0.0132275188531072, 0.0028785619303405099, 0.0031501772124938499]),
    (a: [1.0, 1.70317952871362, 5.0152877574160399, 5.3280607744085904, 7.9609819232659804, 5.2388785010809196, 4.8488198012471999, 1.6190549785696899, 0.93469647237834597], b: [0.0031549033961562399, 0.0053349257686195204, 0.015612337687801301, 0.016625786217075899, 0.024951447525004, 0.016625786217075899, 0.015612337687801301, 0.0053349257686195204, 0.0031549033961562399]),
    (a: [1.0, 2.5140619061872802, 6.2934015438495798, 8.3942314656327106, 10.5877459629868, 8.2454436468666206, 6.0722909052654304, 2.3826974471620299, 0.93095082092189496], b: [0.0031605624836081102, 0.0078781380299657502, 0.019592661068906302, 0.0261739547654984, 0.033184901053375002, 0.026173954765498501, 0.019592661068906399, 0.0078781380299658005, 0.0031605624836081301]),
    (a: [1.0, 3.34113642445435, 8.10507899199912, 12.1562926052344, 14.462889976945, 11.9281214766393, 7.8036751863535603, 3.1564658211257299, 0.92699887711404705], b: [0.0031672875856891898, 0.010475694948883601, 0.025236370484006301, 0.037878718568647503, 0.045329961175600002, 0.0378787185686476, 0.025236370484006301, 0.0104756949488837, 0.0031672875856891998]),
    (a: [1.0, 4.1700640026406504, 10.4355773663123, 16.781312917148, 19.709825692983799, 16.4477691249988, 10.024857426225401, 3.9262785513232199, 0.92283031202098498], b: [0.0031752289843931798, 0.0130840806671933, 0.032496159227648702, 0.052257152831332102, 0.061767264252217402, 0.052257152831331997, 0.032496159227648598, 0.0130840806671932, 0.0031752289843931599]),
    (a: [1.0, 4.9823833616924302, 13.219280600569, 22.348859344642101, 26.3639662273258, 21.878487451389301, 12.6686729582163, 4.6743333377329996, 0.91843440599100101], b: [0.0031845562802270402, 0.015646997517481599, 0.041166378866685102, 0.069551187597775094, 0.0825998306110034, 0.069551187597774997, 0.041166378866685102, 0.015646997517481599, 0.0031845562802270298]),
    (a: [1.0, 5.7550198931566197, 16.326056867468001, 28.779190797822999, 34.287437921565299, 28.137815126536999, 15.606464325779299, 5.3787451523155303, 0.91380005025438205], b: [0.0031954608137085001, 0.018093708981559702, 0.050840777857542603, 0.089504007415841497, 0.10738538716814799, 0.089504007415841497, 0.050840777857542603, 0.018093708981559702, 0.0031954608137085001]),
    (a: [], b: []),
    (a: [], b: []),
    (a: [], b: []),
    (a: [], b: []),
    (a: [], b: []),
    (a: [], b: []),
    (a: [], b: [])
  ]

private let filterDelays: [Int] = [
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  908,
  873,
  795,
  764,
  709,
  681,
  654,
  618,
  583,
  541,
  511,
  482,
  455,
  430,
  399,
  383,
  362,
  341,
  323,
  299,
  293,
  272,
  257,
  242,
  237,
  212,
  211,
  193,
  185,
  172,
  157,
  156,
  137,
  142,
  127,
  122,
  113,
  107,
  107,
  487,
  467,
  434,
  403,
  380,
  353,
  333,
  326,
  302,
  291,
  274,
  246,
  240,
  219,
  218,
  195,
  191,
  184,
  168,
  167,
  152,
  144,
  138,
  133,
  121,
  124,
  108,
  99,
  97,
  88,
  92,
  82,
  77,
  74,
  83,
  80,
  305,
  298,
  263,
  244,
  234,
  225,
  213,
  201,
  190,
  179,
  152,
  163,
  156,
  143,
  135,
  132,
  118,
  131,
  111,
  100,
  93,
  91,
  86,
  80,
  79,
  0,
  0,
  0,
  0,
  0,
  0,
  0
]
